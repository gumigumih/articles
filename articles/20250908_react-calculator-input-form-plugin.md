---
title: "【npm公開】React電卓入力フォームプラグインを公開しました！税込税抜計算機能付きで、あらゆる金額入力シーンに対応"
emoji: "🧮"
type: "tech"
topics: ["react", "typescript", "npm", "plugin", "calculator"]
published: true
---

# はじめに

こんにちは、ぐみと申します！

今回は、私が開発・公開した **React電卓入力フォームプラグイン「@gumigumih/react-calculator-input-form」** について紹介しますね。

このプラグインは、Reactアプリケーションで金額入力が必要な場面で、電卓機能と税込税抜計算機能を簡単に実装できるようにするものです。

# プラグインの概要

## 基本情報

- **パッケージ名**: `@gumigumih/react-calculator-input-form`
- **バージョン**: 1.1.2（最新）
- **ライセンス**: MIT
- **対応環境**: React 18+
- **TypeScript**: 完全対応

## 主な特徴

### 🧮 基本的な電卓機能
- 四則演算（加算、減算、乗算、除算）
- 小数点以下対応

### 💰 税計算機能
- 税込計算（8%、10%）
- 税抜計算（8%、10%）
- 税計算の有効/無効切り替え

### 🔧 高度なカスタマイズ
- `react-number-format`完全対応
- 数値フォーマットの詳細設定（通貨記号、3桁区切り、小数点制御など）
- キーボードショートカット対応

# 開発の背景

## なぜこのプラグインを作ったのか

実は、私自身、Reactでアプリケーションを開発する際に、以下のような課題に直面していました：

1. **同じような入力UIの実装を繰り返していた**
   - 「わりまる」（割り勘計算アプリ）で電卓入力UIを実装
   - 「わけたべ」（割り勘アプリ）でも同様の入力UIが必要
   - 似たような機能を毎回一から実装する無駄

2. **金額入力の実装が面倒**
   - 電卓機能を一から実装する必要がある
   - 税計算のロジックを毎回書く必要がある
   - 数値フォーマットの処理が複雑

3. **既存のライブラリとの統合が困難**
   - 電卓コンポーネントと数値フォーマットの連携が大変
   - スタイリングの統一が難しい
   - モバイル対応が不十分

4. **再利用性の低さ**
   - プロジェクトごとに似たような実装を繰り返す
   - コードの保守性が低い
   - テストの重複

これらの課題を解決するため、**「わりまる」と「わけたべ」で共通して使える、使いやすく、カスタマイズ可能で、高品質な電卓入力フォームプラグイン**の開発を決意しました。

## 設計思想

### 1. シンプルさの追求
- 最小限の設定で動作する
- 直感的なAPI設計
- 学習コストの低さ

### 2. 柔軟性の重視
- 既存のUIライブラリとの親和性
- カスタマイズ可能なオプション
- 様々なユースケースへの対応

**オプション設定できる項目を柔軟に設けて、説明サイトにデモをたくさん用意しました！** これにより、ユーザーが自分の用途に合わせてカスタマイズしやすくなっています。

### 3. 品質の保証
- TypeScriptによる型安全性
- 包括的なテスト
- 継続的なメンテナンス

# 使用方法

## インストール

```bash
npm install @gumigumih/react-calculator-input-form
```

## 基本的な使用方法

### 最も簡単な使用方法（推奨）

```tsx
import { CalculatorInputForm } from '@gumigumih/react-calculator-input-form';

function App() {
  const [amount, setAmount] = useState('');

  return (
    <div>
      <CalculatorInputForm
        value={amount}
        onChange={setAmount}
        title="金額入力"
        description="税込・税抜や小数計算に対応"
        className="w-full px-3 py-2 border border-gray-300 rounded-md"
        placeholder="クリックして金額を入力"
      />
      <p>金額: {amount}円</p>
    </div>
  );
}
```

## カスタマイズ例

### react-number-formatの活用

このプラグインは`react-number-format`と完全に統合されているため、豊富な数値フォーマット機能を利用できます。

**より詳細なカスタマイズ例やデモは、[説明サイト](https://gumigumih.github.io/react-calculator-input-form/)で確認できます！**

#### 日本円フォーマット

```tsx
<CalculatorInputForm
  value={amount}
  onChange={setAmount}
  numberFormatOptions={{
    prefix: "¥",
    thousandSeparator: true,
    decimalScale: 0,
    allowNegative: false
  }}
/>
```

#### ドルフォーマット

```tsx
<CalculatorInputForm
  value={amount}
  onChange={setAmount}
  numberFormatOptions={{
    prefix: "$",
    thousandSeparator: ",",
    decimalSeparator: ".",
    decimalScale: 2,
    suffix: " USD"
  }}
/>
```

#### パーセントフォーマット

```tsx
<CalculatorInputForm
  value={amount}
  onChange={setAmount}
  numberFormatOptions={{
    suffix: "%",
    decimalScale: 2,
    allowNegative: false
  }}
/>
```

### プラグイン固有の機能

#### 税計算を無効化

```tsx
<CalculatorInputForm
  value={amount}
  onChange={setAmount}
  enableTaxCalculation={false}
  decimalPlaces={2}
/>
```

## 実際の使用例

## 1. 割り勘計算アプリ「わりまる」での活用

私が開発した割り勘計算アプリ「わりまる」では、このプラグインを活用して金額入力のUXを大幅に改善しました。

### 改善前
- テキスト入力のみ
- 税計算が手動
- 数値フォーマットが不統一

### 改善後
- 電卓による直感的な入力
- 自動税計算
- 統一された数値フォーマット

## 2. 割り勘アプリ「わけたべ」での活用

同じく私が開発した割り勘アプリ「わけたべ」でも、このプラグインを活用しています。両アプリで同じ入力UIを使用することで、ユーザーにとって一貫した体験を提供できています。

### アプリの違い
- **わりまる**: シンプルな人ごとの支払い入力（複数人がお金を支払っている時の割り勘）
- **わけたべ**: 料理ごとの詳細な割り勘（レストランで注文した料理を食べた人で割り勘）

### 共通化のメリット
- **一貫したUI/UX**: 両アプリで同じ操作感
- **開発効率の向上**: プラグインの改善が両アプリに反映
- **保守性の向上**: 一箇所での機能管理
- **ユーザー体験の統一**: 学習コストの削減

## 3. その他の活用シーン

- **ECサイト**: 商品価格の入力・編集
- **経費管理アプリ**: 支出金額の記録
- **請求書システム**: 金額の計算・入力
- **家計簿アプリ**: 収支の記録

# 技術的な実装ポイント

## アーキテクチャ設計

### 1. コンポーネントの設計
- `CalculatorInputForm`: 入力フィールドと電卓を統合したコンポーネント
- 再利用性と保守性を重視した設計

### 2. 状態管理
- React Hooksを活用した状態管理
- 外部からの状態制御に対応
- パフォーマンスを考慮した実装

### 3. 型安全性
- TypeScriptによる完全な型定義
- プロパティの必須/任意の明確化
- カスタム型の活用

## 実装で工夫したこと

- 最小設定で使えるAPI設計（必須プロップスを絞り、初期値を手厚く用意）
- 表示（フォーマット/UI）と計算（税/丸め）の責務分離で誤差や複雑さを抑制
- スタイルを同梱し、追加のimport不要で動く初期体験を提供
- ショートカットやフォーカス管理を整理し、入力体験を高速化
- デモとドキュメントを多数用意し、利用シーン別に学習コストを低減

## 技術課題と対策

## 型定義と数値フォーマットの統合

- 課題: 数値フォーマットコンポーネントとの型整合性。`numberFormatOptions` 相当の型表現でプロップスの安全性を保つ必要がある。
- 対策: 既存ライブラリの型を再利用し、不要な再定義を避ける。型の表面積を広げず、必要最小限の拡張に留める。

## 初期化順序とDOM依存の問題

- 課題: `document.body` 初期化前の処理でモーダル生成やスタイル適用が失敗する。
- 対策: 初期化タイミングを明示化し、スタイルはバンドルに同梱して追加の import を不要化。副作用の発火条件を限定する。

## 税計算と小数処理の安定性

- 課題: 税込/税抜切替時の丸め誤差と小数点桁の揺れ。
- 対策: 計算ユーティリティを分離し、丸め規則（銀行丸め/四捨五入等）をオプション化。内部表現は文字列/Decimal系で扱い、表示と計算を分離。

## カスタマイズ性と安全性の両立

- 課題: 高いカスタマイズを許容しつつ、破壊的な挙動を防ぐ。
- 対策: 既定値を手厚く用意し、プロップスの組合せ不正は型で抑制。キーボード操作やアクセシビリティは制約付きの拡張ポイントに集約。

## 今後の展望

## 長期目標

**多言語対応**

- UIテキストの多言語化（タイトル、説明文、プレースホルダー）
- 税計算の地域対応（各国の税率設定）
- エラーメッセージの多言語化
- 英語でのドキュメント充実

## まとめ

`@gumigumih/react-calculator-input-form`プラグインは、Reactアプリケーションでの金額入力の課題を解決し、開発効率とユーザー体験の両方を向上させることを目指して開発されました。

## 主な価値

1. **開発効率の向上**
   - 電卓機能の実装時間を大幅短縮
   - 税計算ロジックの実装不要
   - 数値フォーマットの統一

2. **ユーザー体験の改善**
   - 直感的な電卓操作
   - 正確な税計算
   - 統一されたUI/UX

3. **保守性の向上**
   - 一箇所での機能管理
   - 継続的な改善とアップデート
   - コミュニティによる品質向上

## 今後の展開

このプラグインを通じて、Reactエコシステムの発展に貢献し、より多くの開発者とユーザーに価値を提供していきたいと思います。

ぜひ一度お試しください！ご意見やご要望もお聞かせくださいね。

---

📚 **関連リンク**

- [npmパッケージ](https://www.npmjs.com/package/@gumigumih/react-calculator-input-form)
- [GitHubリポジトリ](https://github.com/gumigumih/react-calculator-input-form)
- [ドキュメント](https://gumigumih.github.io/react-calculator-input-form/)
- [わりまる（複数人での支払い割り勘）](https://warimaru.meggumi.com/)
- [わけたべ（料理ごとの詳細割り勘）](https://waketabe.meggumi.com/)

---

最後まで読んでいただき、ありがとうございました！
もし気に入っていただけましたら、ぜひシェアをお願いします。

また、ご意見・ご要望などございましたら、お気軽にコメントください。
